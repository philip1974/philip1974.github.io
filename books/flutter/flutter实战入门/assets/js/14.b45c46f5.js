(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{714:function(t,e,r){"use strict";r.r(e);var a=r(44),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("blockquote",[r("p",[t._v("老孟导读：此文翻译自：https://medium.com/@suragch/my-first-disappointment-with-flutter-5f6967ba78bf")])]),t._v(" "),r("p",[r("img",{attrs:{src:"http://img.laomengit.com/20200903223549.jpeg",alt:""}})]),t._v(" "),r("p",[t._v("我喜欢Flutter。我喜欢开发一次并让代码在Android和iOS上运行。我喜欢节省多少时间。我喜欢现在成为一名Web开发人员，而无需做任何额外的工作。我喜欢hot reload。我喜欢通过将小部件组合到布局中来快速构建UI。我喜欢制作ListView简单得多。我喜欢状态管理。 （好吧，只是在开玩笑。但是我可以应付。）我喜欢Dart。我喜欢Future和async / await比Android AsyncTasks甚至iOS Dispatch Queue容易得多。")]),t._v(" "),r("p",[t._v("但是，在花了最后两周的时间研究Flutter如何呈现文本后，我对使用的工具感到失望。")]),t._v(" "),r("p",[t._v("我们被告知：")]),t._v(" "),r("blockquote",[r("p",[t._v("Flutter的分层体系结构使您可以控制屏幕上的每个像素。")])]),t._v(" "),r("p",[t._v("这显然不适用于用于绘制文本的像素。")]),t._v(" "),r("h3",{attrs:{id:"flutter中的低级文字功能"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#flutter中的低级文字功能"}},[t._v("#")]),t._v(" Flutter中的低级文字功能")]),t._v(" "),r("p",[t._v("Flutter使用名为LibTxt的库结合使用Skia，Hafbuzz，Minikin和ICU来呈现文本。开发人员在使用Text小部件或TextSpan甚至是TextPainter时间接使用它。在最低级别上，我们可以使用dart：iu，它是使用ParagraphBuilder构建的Paragraph类。这些类基本上只是底层LibTxt引擎的包装器。几乎所有工作都由此引擎完成，而在dart：ui中几乎没有暴露。")]),t._v(" "),r("p",[t._v("Paragraph类为我们提供了以下控制：")]),t._v(" "),r("ul",[r("li",[t._v("Size：我可以获取整个渲染段落的宽度和高度，它可以是单行或多行。")]),t._v(" "),r("li",[t._v("距基线的距离（仅对于第一行）")]),t._v(" "),r("li",[t._v("文本是否溢出了maxLines变量。")]),t._v(" "),r("li",[t._v("文本框的大小和相对位置。这是一个例子：")])]),t._v(" "),r("p",[r("img",{attrs:{src:"http://img.laomengit.com/20200903223555.png",alt:""}})]),t._v(" "),r("ul",[r("li",[t._v("最接近某个像素位置的文本字符索引。在上面的示例中，像素（1、1）对应于字符串中的索引0，即“My text line.”的字母“ M”。")]),t._v(" "),r("li",[t._v("字符串中某些字符偏移的单词边界。")])]),t._v(" "),r("p",[t._v("随后的更新也为我们提供了"),r("a",{attrs:{href:"https://medium.com/swlh/flutter-line-metrics-fd98ab180a64",target:"_blank",rel:"noopener noreferrer"}},[t._v("LineMetrics"),r("OutboundLink")],1),t._v("，它为每行提供了许多详细信息：")]),t._v(" "),r("div",{staticClass:"language-dart line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-dart"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LineMetrics")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" bool hardBreak"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" double ascent"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" double descent"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" double unscaledAscent"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" double height"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" double width"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" double left"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" double baseline"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" int lineNumber"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br"),r("span",{staticClass:"line-number"},[t._v("4")]),r("br"),r("span",{staticClass:"line-number"},[t._v("5")]),r("br"),r("span",{staticClass:"line-number"},[t._v("6")]),r("br"),r("span",{staticClass:"line-number"},[t._v("7")]),r("br"),r("span",{staticClass:"line-number"},[t._v("8")]),r("br"),r("span",{staticClass:"line-number"},[t._v("9")]),r("br"),r("span",{staticClass:"line-number"},[t._v("10")]),r("br"),r("span",{staticClass:"line-number"},[t._v("11")]),r("br")])]),r("p",[r("img",{attrs:{src:"http://img.laomengit.com/20200903223559.png",alt:""}})]),t._v(" "),r("p",[t._v("但是，我们没有得到：")]),t._v(" "),r("ul",[r("li",[t._v("一种在文本框中获取实际文本的方法。")]),t._v(" "),r("li",[t._v("一种控制文本布局方式的方法。")]),t._v(" "),r("li",[t._v("一种在路径上绘制文本的方法。")]),t._v(" "),r("li",[t._v("一种无需绘制整个段落即可测量和绘制短文本的方法。")]),t._v(" "),r("li",[t._v("一种从文本字符串获取换行位置的方法")])]),t._v(" "),r("h3",{attrs:{id:"与android和ios的比较"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#与android和ios的比较"}},[t._v("#")]),t._v(" 与Android和iOS的比较")]),t._v(" "),r("p",[t._v("在Android中，尽管大多数人会使用TextView，但是您可以通过使用StaticLayout，Canvas和Paint类获得低级控件来执行上面列出的所有操作。以下是可用的众多选项中的几个：")]),t._v(" "),r("ul",[r("li",[t._v("[Canvas.drawTextOnPath](https://developer.android.com/reference/android/graphics/Canvas.html#drawTextOnPath(java.lang.String, android.graphics.Path, float, float, android.graphics.Paint))")]),t._v(" "),r("li",[t._v("[Canvas.drawTextRun](https://developer.android.com/reference/android/graphics/Canvas.html#drawTextRun(char[], int, int, int, int, float, float, boolean, android.graphics.Paint))")]),t._v(" "),r("li",[r("a",{attrs:{href:"https://developer.android.com/reference/android/graphics/Paint.html#getFontMetrics(android.graphics.Paint.FontMetrics)",target:"_blank",rel:"noopener noreferrer"}},[t._v("Paint.getFontMetrics"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("[Paint.measureText](https://developer.android.com/reference/android/graphics/Paint.html#measureText(java.lang.String, int, int))")])]),t._v(" "),r("p",[t._v("我在iOS上没有那么低级的文字绘制经验（因为我认为我只会学习在Flutter中做所有事情），但是Core Text具有丰富的工具集。")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/flutter/flutter/wiki/Style-guide-for-Flutter-repo#avoid-the-lowest-common-denominator",target:"_blank",rel:"noopener noreferrer"}},[t._v("Flutter 指南"),r("OutboundLink")],1),t._v("中如此说：")]),t._v(" "),r("blockquote",[r("p",[t._v("以多个平台为目标的SDK是很常见的……提供可在所有目标平台上运行的API。不幸的是，这通常意味着一个平台或另一个平台独有的功能不可用。")]),t._v(" "),r("p",[t._v("对于Flutter，我们希望通过明确地成为每个平台的最佳开发方式来避免这种情况。我们在跨平台上使用的能力仅次于我们在每个平台上使用的能力。 （添加了重点）")])]),t._v(" "),r("p",[t._v("当前，对于需要在应用程序中进行低级文本渲染的我们当中，Flutter并不是最好的开发平台。")]),t._v(" "),r("h3",{attrs:{id:"用例"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#用例"}},[t._v("#")]),t._v(" 用例")]),t._v(" "),r("p",[t._v("您可能会说Flutter已经提供了Text和RichText小部件。是的，他们非常好。他们将满足99.9％的开发人员的需求。但是，存在使用较低级别的文本呈现工具的用例。")]),t._v(" "),r("h4",{attrs:{id:"蒙文"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#蒙文"}},[t._v("#")]),t._v(" 蒙文")]),t._v(" "),r("p",[t._v("我的用例是布局并渲染传统的蒙古文字，该文字垂直书写，并从左到右换行。英语是侧身书写，但CJK和表情符号字符应保持其正常方向。")]),t._v(" "),r("p",[r("img",{attrs:{src:"http://img.laomengit.com/20200903223604.png",alt:""}})]),t._v(" "),r("p",[t._v("有一些使用小部件组合的“"),r("a",{attrs:{href:"https://stackoverflow.com/questions/56782788/vertical-text-widget-for-flutter",target:"_blank",rel:"noopener noreferrer"}},[t._v("解决方案"),r("OutboundLink")],1),t._v("”，但是当您添加文本样式的需要时（例如通过在文本的右侧绘制一条垂直线来“下划线”），一种更可靠的解决方案是处理所有文本手工测量，布置和绘画。我已经开始在"),r("a",{attrs:{href:"https://pub.dev/packages/mongol",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里工作了"),r("OutboundLink")],1),t._v("。")]),t._v(" "),r("h4",{attrs:{id:"中文，日文和韩文"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#中文，日文和韩文"}},[t._v("#")]),t._v(" 中文，日文和韩文")]),t._v(" "),r("p",[t._v("中文，日文和韩文也可以按各种垂直方向进行布局。像蒙古语一样，有一种解决方法，可以解决一次性情况，但对于常用用法，渲染包会更有帮助。阅读此内容以更详细地描述需求。")]),t._v(" "),r("p",[r("img",{attrs:{src:"http://img.laomengit.com/20200903223609.png",alt:""}})]),t._v(" "),r("p",[t._v("Flutter仅支持支持从右到左和从左到右的布局。不支持（也"),r("a",{attrs:{href:"https://github.com/flutter/flutter/issues/15710#issuecomment-470418200",target:"_blank",rel:"noopener noreferrer"}},[t._v("不支持"),r("OutboundLink")],1),t._v("😞）垂直布局。我不会对此表示怀疑。有很多工作。但是我希望他们会给我们更多工具来自己做。")]),t._v(" "),r("h4",{attrs:{id:"艺术文字"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#艺术文字"}},[t._v("#")]),t._v(" 艺术文字")]),t._v(" "),r("p",[t._v("进行文字绘画的应用程序也将从对文字绘画工具的低级别访问中受益。")]),t._v(" "),r("p",[r("img",{attrs:{src:"http://img.laomengit.com/20200903223613.png",alt:""}})]),t._v(" "),r("h4",{attrs:{id:"用文本填充非矩形形状"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#用文本填充非矩形形状"}},[t._v("#")]),t._v(" 用文本填充非矩形形状")]),t._v(" "),r("p",[t._v("为了使文本适合非矩形的内容，您必须进行大量测量。换行在哪里是另一个难题。")]),t._v(" "),r("p",[r("img",{attrs:{src:"http://img.laomengit.com/20200903223616.png",alt:""}})]),t._v(" "),r("h4",{attrs:{id:"文字围绕排除路径流动"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#文字围绕排除路径流动"}},[t._v("#")]),t._v(" 文字围绕排除路径流动")]),t._v(" "),r("p",[t._v("这在iOS中可用，但在Flutter中不可用。而且没有简单的方法可以自己实现。")]),t._v(" "),r("p",[r("img",{attrs:{src:"http://img.laomengit.com/20200903223622.png",alt:""}})]),t._v(" "),r("h3",{attrs:{id:"结论"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#结论"}},[t._v("#")]),t._v(" 结论")]),t._v(" "),r("p",[t._v("我并不是想说服任何人不要使用Flutter。我还是很喜欢我再也不想回到为不同平台构建同一应用程序的多次了。")]),t._v(" "),r("p",[t._v("在撰写本文时，我希望有人会说：“不，你错了。如果您这样做，那么您将可以使用低级文本呈现工具。”不过，我对此并没有寄予太大希望，因为Flutter的主要开发人员之一"),r("a",{attrs:{href:"https://github.com/flutter/flutter/issues/15710#issuecomment-470418200",target:"_blank",rel:"noopener noreferrer"}},[t._v("对此表示"),r("OutboundLink")],1),t._v("：")]),t._v(" "),r("blockquote",[r("p",[t._v("如果您想要“真实的”垂直文本，并带有强调标记，"),r("em",[t._v("ruby")]),t._v("和内联水平的"),r("em",[t._v("bidi")]),t._v("文本以及所有内容，那么我能提供的最好的办法是，您可以尝试使用我们提供的较差的原语编写一个程序包来支持此操作，但是可能不会是令人满意的体验。")])]),t._v(" "),r("p",[t._v("我真正希望的是Flutter小组将为我们提供与UI布局级别一样的文本自由。添加一个dart：ui类以暴露更多LibTxt库并不是特别困难。的确，维护起来会更多，开发人员可能偶尔会用它来编写效率低下的代码，但我认为自由值得付出代价。使Flutter成为使用任何语言开发任何平台的最佳方式。")]),t._v(" "),r("h3",{attrs:{id:"_2020年2月更新"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2020年2月更新"}},[t._v("#")]),t._v(" 2020年2月更新")]),t._v(" "),r("p",[t._v("当我最初发布这篇文章时，Flutter团队迅速做出了回应（请参阅下面的评论）。许多工作正在完成（如"),r("a",{attrs:{href:"https://github.com/flutter/flutter/issues/35994",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub问题所记录"),r("OutboundLink")],1),t._v("，谢谢"),r("a",{attrs:{href:"https://github.com/GaryQian",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gary Qian"),r("OutboundLink")],1),t._v("），并且希望可能会有一些重大的改进。但是，尽管遭到了强烈支持，但该GitHub问题最终因其工作量过多而被关闭。")]),t._v(" "),r("p",[t._v("我"),r("a",{attrs:{href:"https://github.com/flutter/flutter/issues/35994#issuecomment-584447738",target:"_blank",rel:"noopener noreferrer"}},[t._v("最近得知"),r("OutboundLink")],1),t._v("，正在完成用Skia SkParagraph模块替换LibTxt的工作。这听起来很令人兴奋，但是我还不知道细节。您可以在此处"),r("a",{attrs:{href:"https://github.com/flutter/flutter/issues/39420",target:"_blank",rel:"noopener noreferrer"}},[t._v("跟踪进度"),r("OutboundLink")],1),t._v("。由于这是一项重大更改，因此现在是让Flutter团队了解您的需求与自定义文本呈现相关的好时机。请参阅以下部分。")]),t._v(" "),r("h3",{attrs:{id:"你可以做什么"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#你可以做什么"}},[t._v("#")]),t._v(" 你可以做什么")]),t._v(" "),r("p",[t._v("即使以下问题当前已关闭（尽管尚未解决），如果您还需要执行自定义文本呈现，请继续对其进行投票并在其上留下评论。")]),t._v(" "),r("p",[t._v("地址："),r("a",{attrs:{href:"https://github.com/flutter/flutter/issues/35994",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/flutter/flutter/issues/35994"),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("为了将问题分解为更小的部分，我添加了以下特定功能要求。如果您还需要它们，请投票和/或评论。")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/flutter/flutter/issues/50171",target:"_blank",rel:"noopener noreferrer"}},[t._v("Need a line/word breaker for custom text rendering #50171"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/flutter/flutter/issues/51258",target:"_blank",rel:"noopener noreferrer"}},[t._v("Need to find how much of a long word could fit in one line before an unnatural line break #51258"),r("OutboundLink")],1)])]),t._v(" "),r("p",[t._v("我尚未提交任何具体的错误报告，但与许多小型Paragraph对象的测量和绘画效率有关。原因是我自己没有发现任何性能问题。如果您遇到过此类问题，请创建一个详细的GitHub问题，并@suragch me。我会在这里链接到它。")])])}),[],!1,null,null,null);e.default=n.exports}}]);