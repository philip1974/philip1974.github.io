(window.webpackJsonp=window.webpackJsonp||[]).push([[279],{979:function(n,t,s){"use strict";s.r(t);var e=s(44),i=Object(e.a)({},(function(){var n=this,t=n.$createElement,s=n._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("h1",{attrs:{id:"animatedlist"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#animatedlist"}},[n._v("#")]),n._v(" AnimatedList")]),n._v(" "),s("p",[n._v("AnimatedList提供了一种简单的方式使列表数据发生变化时加入过渡动画，")]),n._v(" "),s("p",[n._v("下面是一种动画效果：\n"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20191224201321729.gif",alt:""}})]),n._v(" "),s("p",[n._v("AnimatedList主要属性如下表。")]),n._v(" "),s("table",[s("thead",[s("tr",[s("th",[n._v("属性")]),n._v(" "),s("th",[n._v("说明")])])]),n._v(" "),s("tbody",[s("tr",[s("td",[n._v("itemBuilder")]),n._v(" "),s("td",[n._v("一个函数，列表的每一个索引会调用，这个函数有一个animation参数，可以设置成任何一个动画")])]),n._v(" "),s("tr",[s("td",[n._v("initialItemCount")]),n._v(" "),s("td",[n._v("item的个数")])]),n._v(" "),s("tr",[s("td",[n._v("scrollDirection")]),n._v(" "),s("td",[n._v("滚动方向，默认垂直")])]),n._v(" "),s("tr",[s("td",[n._v("controller")]),n._v(" "),s("td",[n._v("scroll控制器")])])])]),n._v(" "),s("p",[n._v("列表数据的插入和删除有进出场动画需要调用AnimatedListState指定的方法，只删除原数据并调用setState方法是没有动画效果的，对应方法如下：")]),n._v(" "),s("blockquote",[s("p",[n._v("AnimatedListState.insertItem\nAnimatedListState.removeItem")])]),n._v(" "),s("p",[n._v("AnimatedListState是AnimatedList的状态类，获取AnimatedListState有两个方法：")]),n._v(" "),s("ol",[s("li",[n._v("通过AnimatedList.of(context)方法，代码如下：")])]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("AnimatedList.of(context).insertItem(index);\nAnimatedList.of(context).removeItem(index, (context,animation)=>{});\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br")])]),s("p",[n._v("2） 通过设置key，用法如下：")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("final GlobalKey<AnimatedListState> _listKey = GlobalKey<AnimatedListState>();\nAnimatedList(\n        key: _listKey,\n        initialItemCount: _list.length,\n        itemBuilder: (BuildContext context, int index, Animation animation) {\n          return _buildItem(_list[index].toString(), animation);\n        },\n      )\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br")])]),s("p",[n._v("调用如下：")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("_listKey.currentState.insertItem(_index);\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("p",[n._v("需要注意的是AnimatedListState.insertItem或者AnimatedListState.removeItem并不会更新实际数据，需要手动处理。\n下面的代码实现了“左进右出”的动画效果：")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("class AnimatedListDemo extends StatefulWidget {\n  @override\n  State<StatefulWidget> createState() => _AnimatedListDemo();\n}\n\nclass _AnimatedListDemo extends State<AnimatedListDemo>\n    with SingleTickerProviderStateMixin {\n  List<int> _list = [];\n  final GlobalKey<AnimatedListState> _listKey = GlobalKey<AnimatedListState>();\n\n  void _addItem() {\n    final int _index = _list.length;\n    _list.insert(_index, _index);\n    _listKey.currentState.insertItem(_index);\n  }\n\n  void _removeItem() {\n    final int _index = _list.length - 1;\n    var item = _list[_index].toString();\n    _listKey.currentState.removeItem(\n        _index, (context, animation) => _buildItem(item, animation));\n    _list.removeAt(_index);\n\n  }\n\n  Widget _buildItem(String _item, Animation _animation) {\n    return SlideTransition(\n      position: _animation.drive(CurveTween(curve: Curves.easeIn)).drive(Tween<Offset>(begin: Offset(1,1),end: Offset(0,1))),\n      child: Card(\n        child: ListTile(\n          title: Text(\n            _item,\n          ),\n        ),\n      ),\n    );\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      body: AnimatedList(\n        key: _listKey,\n        initialItemCount: _list.length,\n        itemBuilder: (BuildContext context, int index, Animation animation) {\n          return _buildItem(_list[index].toString(), animation);\n        },\n      ),\n      floatingActionButton: Row(\n        mainAxisAlignment: MainAxisAlignment.center,\n        crossAxisAlignment: CrossAxisAlignment.center,\n        children: <Widget>[\n          FloatingActionButton(\n            onPressed: () => _addItem(),\n            child: Icon(Icons.add),\n          ),\n          SizedBox(\n            width: 60,\n          ),\n          FloatingActionButton(\n            onPressed: () => _removeItem(),\n            child: Icon(Icons.remove),\n          ),\n        ],\n      ),\n    );\n  }\n}\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br"),s("span",{staticClass:"line-number"},[n._v("28")]),s("br"),s("span",{staticClass:"line-number"},[n._v("29")]),s("br"),s("span",{staticClass:"line-number"},[n._v("30")]),s("br"),s("span",{staticClass:"line-number"},[n._v("31")]),s("br"),s("span",{staticClass:"line-number"},[n._v("32")]),s("br"),s("span",{staticClass:"line-number"},[n._v("33")]),s("br"),s("span",{staticClass:"line-number"},[n._v("34")]),s("br"),s("span",{staticClass:"line-number"},[n._v("35")]),s("br"),s("span",{staticClass:"line-number"},[n._v("36")]),s("br"),s("span",{staticClass:"line-number"},[n._v("37")]),s("br"),s("span",{staticClass:"line-number"},[n._v("38")]),s("br"),s("span",{staticClass:"line-number"},[n._v("39")]),s("br"),s("span",{staticClass:"line-number"},[n._v("40")]),s("br"),s("span",{staticClass:"line-number"},[n._v("41")]),s("br"),s("span",{staticClass:"line-number"},[n._v("42")]),s("br"),s("span",{staticClass:"line-number"},[n._v("43")]),s("br"),s("span",{staticClass:"line-number"},[n._v("44")]),s("br"),s("span",{staticClass:"line-number"},[n._v("45")]),s("br"),s("span",{staticClass:"line-number"},[n._v("46")]),s("br"),s("span",{staticClass:"line-number"},[n._v("47")]),s("br"),s("span",{staticClass:"line-number"},[n._v("48")]),s("br"),s("span",{staticClass:"line-number"},[n._v("49")]),s("br"),s("span",{staticClass:"line-number"},[n._v("50")]),s("br"),s("span",{staticClass:"line-number"},[n._v("51")]),s("br"),s("span",{staticClass:"line-number"},[n._v("52")]),s("br"),s("span",{staticClass:"line-number"},[n._v("53")]),s("br"),s("span",{staticClass:"line-number"},[n._v("54")]),s("br"),s("span",{staticClass:"line-number"},[n._v("55")]),s("br"),s("span",{staticClass:"line-number"},[n._v("56")]),s("br"),s("span",{staticClass:"line-number"},[n._v("57")]),s("br"),s("span",{staticClass:"line-number"},[n._v("58")]),s("br"),s("span",{staticClass:"line-number"},[n._v("59")]),s("br"),s("span",{staticClass:"line-number"},[n._v("60")]),s("br"),s("span",{staticClass:"line-number"},[n._v("61")]),s("br"),s("span",{staticClass:"line-number"},[n._v("62")]),s("br"),s("span",{staticClass:"line-number"},[n._v("63")]),s("br"),s("span",{staticClass:"line-number"},[n._v("64")]),s("br"),s("span",{staticClass:"line-number"},[n._v("65")]),s("br"),s("span",{staticClass:"line-number"},[n._v("66")]),s("br"),s("span",{staticClass:"line-number"},[n._v("67")]),s("br"),s("span",{staticClass:"line-number"},[n._v("68")]),s("br")])]),s("p",[n._v("实现从上掉落的效果，只需将_buildItem方法代码修改如下即可：")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("  Widget _buildItem(String _item, Animation _animation) {\n    return SizeTransition(\n      sizeFactor: _animation,\n      child: Card(\n        child: ListTile(\n          title: Text(\n            _item,\n          ),\n        ),\n      ),\n    );\n  }\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br")])])])}),[],!1,null,null,null);t.default=i.exports}}]);